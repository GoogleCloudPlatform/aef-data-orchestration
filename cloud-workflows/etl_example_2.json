main:
  params: [args]
  steps:
   - workflow:
         try:
             steps:
                 
               - Level_1:
                   parallel:
                       branches:
                           
                           - Level_1_Thread_1:
                               steps:
                                   
                                    - etl_1_step1_Group:
                                       steps:
                                          - etl_1_step1:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_1_step1"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-dataflow-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_1
                                              next: "etl_1_step1_Wait"
                                          - etl_1_step1_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 20
                                              next: "etl_1_step1_Status"
                                          - etl_1_step1_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_1.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_1_step1"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-dataflow-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_1
                                              next: "etl_1_step1_EvaluateStatus"
                                          - etl_1_step1_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_1.body == "success"}
                                                  next: "etl_2_step2"
                                              next: "etl_1_step1_Wait"

                                    - etl_2_step2_Group:
                                       steps:
                                          - etl_2_step2:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_2_step2"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_1
                                              next: "etl_2_step2_Wait"
                                          - etl_2_step2_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_2_step2_Status"
                                          - etl_2_step2_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_1.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_2_step2"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_1
                                              next: "etl_2_step2_EvaluateStatus"
                                          - etl_2_step2_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_1.body == "success"}
                                                  next: "continue"
                                              next: "etl_2_step2_Wait"

                           - Level_1_Thread_2:
                               steps:
                                   
                                    - etl_2_step3_Group:
                                       steps:
                                          - etl_2_step3:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_2_step3"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_1
                                              next: "etl_2_step3_Wait"
                                          - etl_2_step3_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_2_step3_Status"
                                          - etl_2_step3_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_1.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_2_step3"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_1
                                              next: "etl_2_step3_EvaluateStatus"
                                          - etl_2_step3_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_1.body == "success"}
                                                  next: "continue"
                                              next: "etl_2_step3_Wait"

               - Level_2:
                   parallel:
                       branches:
                           
                           - Level_2_Thread_1:
                               steps:
                                   
                                    - etl_3_step4_Group:
                                       steps:
                                          - etl_3_step4:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_3_step4"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_2
                                              next: "etl_3_step4_Wait"
                                          - etl_3_step4_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_3_step4_Status"
                                          - etl_3_step4_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_2.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_3_step4"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_2
                                              next: "etl_3_step4_EvaluateStatus"
                                          - etl_3_step4_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_2.body == "success"}
                                                  next: "etl_4_step5"
                                              next: "etl_3_step4_Wait"

                                    - etl_4_step5_Group:
                                       steps:
                                          - etl_4_step5:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_4_step5"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_2
                                              next: "etl_4_step5_Wait"
                                          - etl_4_step5_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_4_step5_Status"
                                          - etl_4_step5_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_2.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_4_step5"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_2
                                              next: "etl_4_step5_EvaluateStatus"
                                          - etl_4_step5_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_2.body == "success"}
                                                  next: "continue"
                                              next: "etl_4_step5_Wait"

                           - Level_2_Thread_2:
                               steps:
                                   
                                    - etl_3_step6_Group:
                                       steps:
                                          - etl_3_step6:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_3_step6"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_2
                                              next: "etl_3_step6_Wait"
                                          - etl_3_step6_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_3_step6_Status"
                                          - etl_3_step6_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_2.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_3_step6"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_2
                                              next: "etl_3_step6_EvaluateStatus"
                                          - etl_3_step6_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_2.body == "success"}
                                                  next: "continue"
                                              next: "etl_3_step6_Wait"
   
               - Level_3_Thread_1:
                   steps:
                       
                        - etl_5_step7_Group:
                           steps:
                              - etl_5_step7:
                                  call: http.post
                                  args:
                                      url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                      auth:
                                          type: OIDC
                                      headers:
                                          Content-Type: "application/json"
                                      body:
                                          call_type: "get_id"
                                          workflow_name: "${args.workflow_name}"
                                          execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                          job_name: "etl_5_step7"
                                          function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                          query_variables: "${args.query_variables}"
                                          workflow_properties: "${args.workflow_properties}"
                                          step_properties: > 
                                                     {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                  result: async_job_id_3
                                  next: "etl_5_step7_Wait"
                              - etl_5_step7_Wait:
                                  call: "sys.sleep"
                                  args:
                                      seconds: 5
                                  next: "etl_5_step7_Status"
                              - etl_5_step7_Status:
                                  call: http.post
                                  args:
                                      url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                      auth:
                                          type: OIDC
                                      headers:
                                          Content-Type: "application/json"
                                      body:
                                          call_type: "get_status"
                                          async_job_id: ${async_job_id_3.body}
                                          workflow_name: "${args.workflow_name}"
                                          execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                          job_name: "etl_5_step7"
                                          function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                          query_variables: "${args.query_variables}"
                                          workflow_properties: "${args.workflow_properties}"
                                  result: job_status_3
                                  next: "etl_5_step7_EvaluateStatus"
                              - etl_5_step7_EvaluateStatus:
                                  switch:
                                    - condition: ${job_status_3.body == "success"}
                                      next: "Level_4"
                                  next: "etl_5_step7_Wait"
               - Level_4:
                   parallel:
                       branches:
                           
                           - Level_4_Thread_1:
                               steps:
                                   
                                    - etl_6_step8_Group:
                                       steps:
                                          - etl_6_step8:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step8"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_4
                                              next: "etl_6_step8_Wait"
                                          - etl_6_step8_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_6_step8_Status"
                                          - etl_6_step8_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_4.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step8"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_4
                                              next: "etl_6_step8_EvaluateStatus"
                                          - etl_6_step8_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_4.body == "success"}
                                                  next: "continue"
                                              next: "etl_6_step8_Wait"

                           - Level_4_Thread_2:
                               steps:
                                   
                                    - etl_6_step9_Group:
                                       steps:
                                          - etl_6_step9:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step9"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_4
                                              next: "etl_6_step9_Wait"
                                          - etl_6_step9_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_6_step9_Status"
                                          - etl_6_step9_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_4.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step9"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_4
                                              next: "etl_6_step9_EvaluateStatus"
                                          - etl_6_step9_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_4.body == "success"}
                                                  next: "continue"
                                              next: "etl_6_step9_Wait"

                           - Level_4_Thread_3:
                               steps:
                                   
                                    - etl_6_step10_Group:
                                       steps:
                                          - etl_6_step10:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step10"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_4
                                              next: "etl_6_step10_Wait"
                                          - etl_6_step10_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_6_step10_Status"
                                          - etl_6_step10_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_4.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step10"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_4
                                              next: "etl_6_step10_EvaluateStatus"
                                          - etl_6_step10_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_4.body == "success"}
                                                  next: "continue"
                                              next: "etl_6_step10_Wait"

                           - Level_4_Thread_4:
                               steps:
                                   
                                    - etl_6_step11_Group:
                                       steps:
                                          - etl_6_step11:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step11"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_4
                                              next: "etl_6_step11_Wait"
                                          - etl_6_step11_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_6_step11_Status"
                                          - etl_6_step11_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_4.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step11"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_4
                                              next: "etl_6_step11_EvaluateStatus"
                                          - etl_6_step11_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_4.body == "success"}
                                                  next: "continue"
                                              next: "etl_6_step11_Wait"

                           - Level_4_Thread_5:
                               steps:
                                   
                                    - etl_6_step12_Group:
                                       steps:
                                          - etl_6_step12:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step12"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_4
                                              next: "etl_6_step12_Wait"
                                          - etl_6_step12_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_6_step12_Status"
                                          - etl_6_step12_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_4.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step12"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_4
                                              next: "etl_6_step12_EvaluateStatus"
                                          - etl_6_step12_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_4.body == "success"}
                                                  next: "continue"
                                              next: "etl_6_step12_Wait"

                           - Level_4_Thread_6:
                               steps:
                                   
                                    - etl_6_step13_Group:
                                       steps:
                                          - etl_6_step13:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_id"
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step13"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                                      step_properties: > 
                                                                 {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                              result: async_job_id_4
                                              next: "etl_6_step13_Wait"
                                          - etl_6_step13_Wait:
                                              call: "sys.sleep"
                                              args:
                                                  seconds: 5
                                              next: "etl_6_step13_Status"
                                          - etl_6_step13_Status:
                                              call: http.post
                                              args:
                                                  url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                                  auth:
                                                      type: OIDC
                                                  headers:
                                                      Content-Type: "application/json"
                                                  body:
                                                      call_type: "get_status"
                                                      async_job_id: ${async_job_id_4.body}
                                                      workflow_name: "${args.workflow_name}"
                                                      execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                                      job_name: "etl_6_step13"
                                                      function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                                      query_variables: "${args.query_variables}"
                                                      workflow_properties: "${args.workflow_properties}"
                                              result: job_status_4
                                              next: "etl_6_step13_EvaluateStatus"
                                          - etl_6_step13_EvaluateStatus:
                                              switch:
                                                - condition: ${job_status_4.body == "success"}
                                                  next: "continue"
                                              next: "etl_6_step13_Wait"
   
               - Level_5_Thread_1:
                   steps:
                       
                        - etl_7_step14_Group:
                           steps:
                              - etl_7_step14:
                                  call: http.post
                                  args:
                                      url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                      auth:
                                          type: OIDC
                                      headers:
                                          Content-Type: "application/json"
                                      body:
                                          call_type: "get_id"
                                          workflow_name: "${args.workflow_name}"
                                          execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                          job_name: "etl_7_step14"
                                          function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                          query_variables: "${args.query_variables}"
                                          workflow_properties: "${args.workflow_properties}"
                                          step_properties: > 
                                                     {"jobs_definitions_bucket":"analytics-engg-framework-demo_aef_jobs_bucket"}
                                  result: async_job_id_5
                                  next: "etl_7_step14_Wait"
                              - etl_7_step14_Wait:
                                  call: "sys.sleep"
                                  args:
                                      seconds: 5
                                  next: "etl_7_step14_Status"
                              - etl_7_step14_Status:
                                  call: http.post
                                  args:
                                      url: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-intermediate"
                                      auth:
                                          type: OIDC
                                      headers:
                                          Content-Type: "application/json"
                                      body:
                                          call_type: "get_status"
                                          async_job_id: ${async_job_id_5.body}
                                          workflow_name: "${args.workflow_name}"
                                          execution_id: ${sys.get_env("GOOGLE_CLOUD_WORKFLOW_EXECUTION_ID")}
                                          job_name: "etl_7_step14"
                                          function_url_to_call: "https://us-central1-analytics-engg-framework-demo.cloudfunctions.net/orch-framework-simple-dataform-query-executor"
                                          query_variables: "${args.query_variables}"
                                          workflow_properties: "${args.workflow_properties}"
                                  result: job_status_5
                                  next: "etl_7_step14_EvaluateStatus"
                              - etl_7_step14_EvaluateStatus:
                                  switch:
                                    - condition: ${job_status_5.body == "success"}
                                      next: "end"
                                  next: "etl_7_step14_Wait"
         except:
             as: e
             steps:
                 - log:
                     call: sys.log
                     args:
                         data: ${e}
                 - unhandled_exception:
                     raise: ${e}